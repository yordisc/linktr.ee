import{e as N,r as c,f as y,C as j,j as e}from"./index-DkdPT0Fo.js";const v=()=>{const{currentThemeId:t,getThemeById:n}=N(),[s,a]=c.useState(null),[l,r]=c.useState({x:20,y:20});return c.useEffect(()=>{const o=n(t)?.joinButton;if(o){if(a(o),o.position==="floating"){const u=localStorage.getItem(`join-button-position-${t}`);if(u)try{r(JSON.parse(u))}catch{r(o.defaultPosition||{x:20,y:20})}else r(o.defaultPosition||{x:20,y:20})}}else a(null)},[t,n]),{joinButtonConfig:s,position:l,savePosition:d=>{r(d),localStorage.setItem(`join-button-position-${t}`,JSON.stringify(d))},isAlwaysVisible:s?.alwaysVisible||!1,isDraggable:s?.draggable||!1,positionType:s?.position||"floating"}},S=({userConfig:t,isDraggable:n})=>{const[s,a]=c.useState(!1),{attributes:l,listeners:r,setNodeRef:i,transform:d,isDragging:o}=y({id:"footer-join-button",disabled:!n}),u={cursor:n?o?"grabbing":"grab":"pointer",transform:j.Translate.toString(d),transition:o?"none":"all 0.3s ease"},x={};return t.backgroundColor&&(x.background=t.backgroundColor),t.textColor&&(x.color=t.textColor),n&&(x.border="2px dashed rgba(255, 255, 255, 0.3)"),e.jsx("div",{className:`fixed bottom-0 left-0 right-0 z-40 p-4 bg-gradient-to-t from-black/20 to-transparent backdrop-blur-sm transition-all duration-300 ${s?"h-32":"h-20"}`,children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsx("div",{ref:i,style:u,...r,...l,className:"relative",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),onTouchStart:()=>a(!0),onTouchEnd:()=>setTimeout(()=>a(!1),1e3),children:e.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"join-button-footer block w-full py-4 px-6 rounded-2xl text-center font-semibold text-lg shadow-2xl transition-all duration-300 hover:scale-105",style:x,onClick:p=>{o&&p.preventDefault()},children:[e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("span",{children:t.text}),n&&e.jsx("span",{className:"text-sm opacity-70 transition-opacity duration-300",children:s?"← Arrastra →":"↔"})]}),s&&n&&e.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-black/80 text-white text-xs py-1 px-2 rounded-lg whitespace-nowrap",children:"Arrastra para mover el botón"})]})})})})},T=({userConfig:t,isVisible:n=!0})=>{const{joinButtonConfig:s,position:a,savePosition:l,isDraggable:r,positionType:i,isAlwaysVisible:d}=v(),[o,u]=c.useState(!1),{attributes:x,listeners:p,setNodeRef:w,transform:b,isDragging:g}=y({id:"join-button-draggable",disabled:!r||i==="footer"});if(c.useEffect(()=>{u(g)},[g]),c.useEffect(()=>{if(!o&&b&&r&&i==="floating"){const h={x:Math.max(0,Math.min(window.innerWidth-200,a.x+b.x)),y:Math.max(0,Math.min(window.innerHeight-100,a.y+b.y))};l(h)}},[o,b,r,a,l,i]),i==="footer")return e.jsx(S,{userConfig:t,isDraggable:r});const m=d||n,k={position:"fixed",left:a.x,top:a.y,zIndex:1e3,cursor:r?o?"grabbing":"grab":"pointer",transform:j.Translate.toString(b),transition:o?"none":"transform 0.2s ease, opacity 0.3s ease, scale 0.3s ease",opacity:o?.8:m?1:0,scale:m?1:.5,pointerEvents:m?"auto":"none"},f={};return t.backgroundColor&&(f.background=t.backgroundColor),t.textColor&&(f.color=t.textColor),r&&(f.boxShadow="0 4px 20px rgba(0, 0, 0, 0.3)"),s?e.jsx("div",{ref:w,style:k,...p,...x,className:`join-button-draggable ${o?"dragging":""}`,children:e.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"join-button",style:Object.keys(f).length>0?f:void 0,onClick:h=>{o&&h.preventDefault()},children:[t.text,r&&e.jsx("span",{style:{marginLeft:"8px",fontSize:"12px",opacity:.7},children:"↔"})]})}):null},E=({config:t,isVisible:n=!0})=>{const{positionType:s,isAlwaysVisible:a}=v();if(!t.enabled)return null;const l={};if(t.backgroundColor&&(l.background=t.backgroundColor),t.textColor&&(l.color=t.textColor),s==="floating")return e.jsx(T,{userConfig:t,isVisible:n});if(s==="footer"){const r=a||n;return e.jsx("div",{className:`fixed bottom-0 left-0 w-full z-50 p-4 transition-transform duration-300 ease-in-out ${r?"translate-y-0":"translate-y-full"}`,children:e.jsxs("div",{className:"max-w-md mx-auto relative",children:[e.jsx("div",{className:"absolute inset-0 bg-white/10 dark:bg-black/20 backdrop-blur-md -z-10 border-t border-white/10 shadow-lg rounded-2xl"}),e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"join-button-footer block w-full text-center py-4 px-6 font-bold text-lg shadow-xl transform active:scale-95 transition-all",style:{...l,borderRadius:`${t.borderRadius||16}px`},children:t.text})]})})}return s==="static"?e.jsx("div",{className:"w-full mx-auto opacity-100 translate-y-0",children:e.jsx("div",{className:"mt-6 pt-6 border-t border-opacity-30",style:{borderColor:"var(--color-border)"},children:e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"join-button w-full block transform active:scale-95 transition-transform",style:l,children:t.text})})}):e.jsx("div",{className:`transition-all duration-300 ease-in-out ${n?"opacity-0 translate-y-10":"opacity-100 translate-y-0"}`,children:e.jsx("div",{className:"w-full mx-auto",children:e.jsx("div",{className:"mt-4 pt-2 border-t border-opacity-50",style:{borderColor:"var(--color-border)"},children:e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"join-button",style:l,children:t.text})})})})};export{E as JoinButton};
