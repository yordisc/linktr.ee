import{r as a,j as m}from"./index-BqBsGcGS.js";const h={CANVAS_WIDTH:360,CANVAS_HEIGHT:640,LANE_COUNT:3,PLAYER_WIDTH:50,PLAYER_HEIGHT:80,GRAVITY:.8,JUMP_FORCE:-14,INITIAL_SPEED:6,DASH_MULTIPLIER:2.5,DIET_PEPSI_DURATION:240,SPAWN_RATE_INITIAL:100,SPAWN_RATE_MIN:30,INITIAL_LIVES:3,CANS_FOR_LIFE:100},k=h.CANVAS_WIDTH/h.LANE_COUNT,M=[k*.5,k*1.5,k*2.5];let H=null;const B=()=>{if(!H){const e=window.AudioContext||window.webkitAudioContext;if(!e)throw new Error("Tu navegador no soporta Web Audio API");H=new e}return H},W=e=>{const i=B();i.state==="suspended"&&i.resume();const t=i.createOscillator(),r=i.createGain();t.connect(r),r.connect(i.destination);const s=i.currentTime;switch(e){case"JUMP":t.type="square",t.frequency.setValueAtTime(150,s),t.frequency.exponentialRampToValueAtTime(600,s+.2),r.gain.setValueAtTime(.1,s),r.gain.exponentialRampToValueAtTime(.01,s+.2),t.start(s),t.stop(s+.2);break;case"SLIDE":t.type="sine",t.frequency.setValueAtTime(400,s),t.frequency.exponentialRampToValueAtTime(100,s+.3),r.gain.setValueAtTime(.1,s),r.gain.linearRampToValueAtTime(0,s+.3),t.start(s),t.stop(s+.3);break;case"COLLECT":t.type="sine",t.frequency.setValueAtTime(1200,s),t.frequency.setValueAtTime(1600,s+.1),r.gain.setValueAtTime(.1,s),r.gain.exponentialRampToValueAtTime(.01,s+.2),t.start(s),t.stop(s+.2);break;case"POWERUP":t.type="triangle",t.frequency.setValueAtTime(440,s),t.frequency.setValueAtTime(554,s+.1),t.frequency.setValueAtTime(659,s+.2),r.gain.setValueAtTime(.1,s),r.gain.linearRampToValueAtTime(0,s+.4),t.start(s),t.stop(s+.4);break;case"CRASH":t.type="sawtooth",t.frequency.setValueAtTime(100,s),t.frequency.exponentialRampToValueAtTime(10,s+.3),r.gain.setValueAtTime(.2,s),r.gain.exponentialRampToValueAtTime(.01,s+.3),t.start(s),t.stop(s+.3);break}},G=()=>({play:a.useCallback(i=>{try{W(i)}catch(t){console.warn("Audio error:",t)}},[])}),q=()=>{const{play:e}=G(),i=a.useRef({lane:1,x:M[1],y:0,isJumping:!1,jumpVelocity:0,isSliding:!1,slideTimer:0,isDashing:!1,dashTimer:0,isHit:!1,hitTimer:0,isConfused:!1,confusionTimer:0,frame:0,cooldowns:{slide:0,dash:0}}),t=a.useCallback(()=>{const n=i.current,f=n.isConfused?1:-1,u=n.lane+f;u>=0&&u<=2&&(n.lane=u)},[]),r=a.useCallback(()=>{const n=i.current,f=n.isConfused?-1:1,u=n.lane+f;u>=0&&u<=2&&(n.lane=u)},[]),s=a.useCallback(()=>{const n=i.current;!n.isJumping&&!n.isSliding&&(n.isJumping=!0,n.jumpVelocity=h.JUMP_FORCE,e("JUMP"))},[e]),l=a.useCallback(()=>{const n=i.current;!n.isJumping&&!n.isSliding&&n.cooldowns.slide<=0&&(n.isSliding=!0,n.slideTimer=60,n.cooldowns.slide=120,e("SLIDE"))},[e]),o=a.useCallback(()=>{const n=i.current;!n.isDashing&&n.cooldowns.dash<=0&&(n.isDashing=!0,n.dashTimer=60,n.cooldowns.dash=240,n.isJumping=!1,n.y=0,n.isSliding=!1,e("POWERUP"))},[e]),c=a.useCallback(()=>{const n=i.current;n.frame++;const f=M[n.lane];n.x+=(f-n.x)*.2,n.isJumping&&(n.y+=n.jumpVelocity,n.jumpVelocity+=h.GRAVITY,n.y<=0&&(n.y=0,n.isJumping=!1,n.jumpVelocity=0)),n.isSliding&&(n.slideTimer--,n.slideTimer<=0&&(n.isSliding=!1)),n.isDashing&&(n.dashTimer--,n.dashTimer<=0&&(n.isDashing=!1)),n.isHit&&(n.hitTimer--,n.hitTimer<=0&&(n.isHit=!1)),n.isConfused&&(n.confusionTimer--,n.confusionTimer<=0&&(n.isConfused=!1)),n.cooldowns.slide>0&&n.cooldowns.slide--,n.cooldowns.dash>0&&n.cooldowns.dash--},[]);return{playerRef:i,updatePlayer:c,actions:{moveLeft:t,moveRight:r,jump:s,slide:l,dash:o}}},J=()=>{const e=a.useRef([]),i=a.useRef(0),t=a.useRef(0),r=a.useCallback(()=>{e.current=[],i.current=0,t.current=0},[]),s=()=>{const o=Math.floor(Math.random()*3),c=`ent-${t.current++}`,n=Math.random()>.3;let f,u,d=50,T=50,R=0,E=!1;if(n){f="OBSTACLE";const S=Math.random();S<.4?u="CONE":S<.7?(u="BARRIER",d=70):S<.85?(u="TRUCK_H",d=90,T=60):S<.95?(u="CAR",R=5,E=!0,d=45,T=80):u="HOLE"}else f="COLLECTIBLE",u=Math.random()>.9?"CAN_DIET":"CAN_NORMAL",d=30,T=45;const y={id:c,type:f,variant:u,lane:o,x:M[o],y:-100,width:d,height:T,speedY:R,warning:E,warningTimer:E?60:0};e.current.push(y)},l=a.useCallback((o,c)=>{i.current++;const n=Math.max(h.SPAWN_RATE_MIN,h.SPAWN_RATE_INITIAL-c*5);i.current>=n&&(s(),i.current=0),e.current=e.current.filter(f=>f.warning&&f.warningTimer&&f.warningTimer>0?(f.warningTimer--,!0):(f.y+=o+(f.speedY||0),f.y<h.CANVAS_HEIGHT+100))},[]);return{entitiesRef:e,updateEntities:l,resetSpawner:r}},X=()=>({checkCollision:a.useCallback((i,t)=>{if(Math.abs(i.x-t.x)>40)return!1;const s=h.CANVAS_HEIGHT-h.PLAYER_HEIGHT-20,l=t.y+t.height,o=t.y,c=s+h.PLAYER_HEIGHT,n=s-i.y;return!(!(l>n&&o<c)||(t.variant==="HOLE"||t.variant==="CAR")&&i.y>t.height||(t.variant==="TRUCK_H"||t.variant==="POLE")&&i.isSliding||i.isDashing&&(t.variant==="BOX"||t.variant==="BARREL"||t.variant==="CONE"))},[])}),K=()=>{const[e,i]=a.useState(0),[t,r]=a.useState(0),[s,l]=a.useState(h.INITIAL_LIVES),[o,c]=a.useState(0),[n,f]=a.useState(1),u=a.useRef(0),d=a.useRef(0);a.useEffect(()=>{const S=localStorage.getItem("pepsiman_highscore");S&&r(parseInt(S,10))},[]);const T=a.useCallback(()=>{i(0),l(h.INITIAL_LIVES),c(0),f(1),u.current=0,d.current=0},[]),R=a.useCallback(S=>{d.current+=S*.1;const g=Math.floor(d.current);if(g>u.current){u.current=g,i(g);const A=Math.floor(g/1e3)+1;A!==n&&f(A)}},[n]),E=a.useCallback(S=>{const g=S==="CAN_DIET"?50:10;u.current+=g,i(A=>A+g),S==="CAN_NORMAL"&&c(A=>{const b=A+1;return b>=h.CANS_FOR_LIFE?(l(w=>w+1),0):b})},[]),y=a.useCallback((S=1)=>{let g=!1;return l(A=>{const b=A-S;return b<=0?(g=!0,u.current>t&&(r(u.current),localStorage.setItem("pepsiman_highscore",u.current.toString())),0):b}),g},[t]);return{score:e,highScore:t,lives:s,cans:o,level:n,resetScore:T,updateDistance:R,collectCan:E,takeDamage:y}},F=1e3/60,$=()=>{const{playerRef:e,updatePlayer:i,actions:t}=q(),{entitiesRef:r,updateEntities:s,resetSpawner:l}=J(),{play:o}=G(),{checkCollision:c}=X(),{score:n,highScore:f,lives:u,cans:d,level:T,resetScore:R,updateDistance:E,collectCan:y,takeDamage:S}=K(),[g,A]=a.useState("MENU"),b=a.useRef(0),w=a.useRef(0),_=a.useRef(h.INITIAL_SPEED),D=a.useRef(0),V=a.useCallback(()=>{const p=e.current;for(let P=r.current.length-1;P>=0;P--){const C=r.current[P];if(c(p,C)){if(C.type==="COLLECTIBLE"){const v=C.variant;y(v),v==="CAN_DIET"?(o("POWERUP"),D.current=h.DIET_PEPSI_DURATION):o("COLLECT"),r.current.splice(P,1)}else if(!p.isHit){const v=["BOX","BARREL","CONE"].includes(C.variant);if(p.isDashing&&v)o("CRASH"),r.current.splice(P,1);else{o("CRASH"),p.isHit=!0,p.hitTimer=60,C.variant==="BARREL"&&(p.isConfused=!0,p.confusionTimer=300);const z=["TRUCK_V","TRUCK_H","HOLE"].includes(C.variant)?999:1;if(S(z))return A("GAME_OVER"),!0;_.current=Math.max(h.INITIAL_SPEED,_.current-2)}}}}return!1},[c,y,S,r,e,o]),L=a.useCallback(p=>{if(g!=="PLAYING")return;w.current||(w.current=p);const P=p-w.current;if(P>F){w.current=p-P%F;let C=_.current+T*.5;if(e.current.isDashing&&(C*=h.DASH_MULTIPLIER),D.current>0&&(C+=5,D.current--),i(),s(C,T),E(C),V())return}b.current=requestAnimationFrame(L)},[g,T,i,s,E,V,e]),Y=a.useCallback(()=>{R(),l(),_.current=h.INITIAL_SPEED,D.current=0;const p=e.current;p.lane=1,p.x=h.CANVAS_WIDTH/3*1.5,p.y=0,p.isHit=!1,p.isJumping=!1,p.isSliding=!1,p.isDashing=!1,p.isConfused=!1,A("PLAYING"),w.current=0,b.current=requestAnimationFrame(L)},[L,R,l,e]),U=a.useCallback(()=>{g==="PLAYING"?A("PAUSED"):g==="PAUSED"&&(A("PLAYING"),w.current=0,b.current=requestAnimationFrame(L))},[g,L]);return a.useEffect(()=>()=>cancelAnimationFrame(b.current),[]),{status:g,startGame:Y,pauseGame:U,player:e.current,entitiesRef:r,stats:{score:n,highScore:f,lives:u,cans:d,level:T},actions:t}},Q=(e,i)=>{const t=a.useRef(0),r=a.useRef(!1);a.useEffect(()=>{const s=o=>{if(e==="PLAYING")switch(o.key){case"ArrowLeft":case"a":i.moveLeft();break;case"ArrowRight":case"d":i.moveRight();break;case"ArrowUp":case"w":i.dash();break;case"ArrowDown":case"s":i.slide();break;case" ":case"Shift":!o.repeat&&t.current===0&&(t.current=Date.now(),r.current=!1,setTimeout(()=>{t.current!==0&&(r.current=!0,i.slide())},200));break}},l=o=>{if(o.key===" "||o.key==="Shift"){const c=Date.now()-t.current;t.current=0,c<200&&!r.current&&i.jump(),r.current=!1}};return window.addEventListener("keydown",s),window.addEventListener("keyup",l),()=>{window.removeEventListener("keydown",s),window.removeEventListener("keyup",l)}},[e,i])},I={},N={PEPSI_BLUE:"#004B93",PEPSI_RED:"#C9002B",SILVER:"#E0E0E0",ASPHALT:"#2D2D2D"},O=(e,i)=>{const t=document.createElement("canvas");return t.width=e,t.height=i,{canvas:t,ctx:t.getContext("2d")}},j=e=>{const{canvas:r,ctx:s}=O(30,50),l=e==="diet"?N.SILVER:N.PEPSI_BLUE,o=s.createLinearGradient(0,0,30,0);o.addColorStop(0,"rgba(0,0,0,0.3)"),o.addColorStop(.2,l),o.addColorStop(.5,e==="diet"?"#FFFFFF":"#0072CE"),o.addColorStop(.8,l),o.addColorStop(1,"rgba(0,0,0,0.3)"),s.fillStyle=o,s.fillRect(0,0,30,50),s.fillStyle="#999",s.fillRect(0,0,30,3),s.fillRect(0,47,30,3);const c=30/2,n=50/2,f=8;return s.beginPath(),s.arc(c,n,f,0,Math.PI*2),s.fillStyle="#FFF",s.fill(),s.beginPath(),s.arc(c,n,f-2,0,Math.PI*2),s.fillStyle=N.PEPSI_RED,s.fill(),s.beginPath(),s.arc(c,n,f-2,0,Math.PI,!1),s.fillStyle=N.PEPSI_BLUE,s.fill(),r},Z=()=>{const{canvas:i,ctx:t}=O(200,200);t.fillStyle=N.ASPHALT,t.fillRect(0,0,200,200);for(let r=0;r<400;r++){const s=Math.random()*200,l=Math.random()*200,o=Math.random()*2;t.fillStyle=Math.random()>.5?"#383838":"#222",t.fillRect(s,l,o,o)}return i},x=()=>{const{canvas:i,ctx:t}=O(50,50);return t.fillStyle="#FBC02D",t.fillRect(0,0,50,50),t.fillStyle="#000",t.beginPath(),t.moveTo(0,50),t.lineTo(50,0),t.lineTo(50,10),t.lineTo(10,50),t.fill(),t.beginPath(),t.moveTo(0,10),t.lineTo(10,0),t.lineTo(0,0),t.fill(),i},ee=()=>{I.CAN_NORMAL||(console.log("ðŸŽ¨ Generando texturas en memoria..."),I.CAN_NORMAL=j("normal"),I.CAN_DIET=j("diet"),I.ASPHALT=Z(),I.STRIPES=x())},te=(e,i,t,r)=>{if(I.ASPHALT){const l=e.createPattern(I.ASPHALT,"repeat");if(l){const o=Date.now()*r*.05%256,c=new DOMMatrix;c.translateSelf(0,o),l.setTransform(c),e.fillStyle=l,e.fillRect(0,0,i,t)}}else e.fillStyle="#2d2d2d",e.fillRect(0,0,i,t);e.fillStyle="#1a1a1a",e.fillRect(0,0,15,t),e.fillRect(i-15,0,15,t);const s=Date.now()*r*.1%40;e.strokeStyle="#FFF",e.lineWidth=4,e.setLineDash([20,20]),e.lineDashOffset=-s,e.beginPath(),e.moveTo(15,0),e.lineTo(15,t),e.stroke(),e.beginPath(),e.moveTo(i-15,0),e.lineTo(i-15,t),e.stroke(),e.strokeStyle="rgba(255, 255, 255, 0.3)",e.lineWidth=2,e.setLineDash([30,50]),e.lineDashOffset=-s,[k,k*2].forEach(l=>{e.beginPath(),e.moveTo(l,0),e.lineTo(l,t),e.stroke()}),e.setLineDash([])},se=(e,i)=>{i.forEach(t=>{const r=t.x,s=t.y+t.height;if(e.fillStyle="rgba(0,0,0,0.3)",e.beginPath(),e.ellipse(r,s,t.width/2.2,6,0,0,Math.PI*2),e.fill(),t.type==="COLLECTIBLE"){const l=t.variant,o=I[l];if(o){const c=Math.sin(Date.now()/200)*5,n=1+Math.sin(Date.now()/150)*.05,f=t.width*n,u=t.height*n;e.drawImage(o,r-f/2,t.y+c,f,u)}else e.fillStyle="blue",e.fillRect(t.x-15,t.y,30,50)}else ne(e,t)})},ne=(e,i)=>{const t=i.x-i.width/2,r=i.y,s=i.width,l=i.height;switch(i.variant){case"BARRIER":if(I.STRIPES){const c=e.createPattern(I.STRIPES,"repeat");c&&(e.fillStyle=c,e.fillRect(t,r,s,20),e.strokeStyle="#000",e.lineWidth=2,e.strokeRect(t,r,s,20))}else e.fillStyle="#FFC107",e.fillRect(t,r,s,20);e.fillStyle="#333",e.fillRect(t+5,r+20,10,l-20),e.fillRect(t+s-15,r+20,10,l-20);break;case"CONE":e.fillStyle="#FF5722",e.beginPath(),e.moveTo(i.x,r),e.lineTo(t,r+l),e.lineTo(t+s,r+l),e.fill(),e.fillStyle="#333",e.fillRect(t-5,r+l-5,s+10,5);break;case"TRUCK_H":case"TRUCK_V":e.fillStyle="#D32F2F",e.fillRect(t,r,s,l),e.fillStyle="#B71C1C",e.fillRect(t,r+l-10,s,10),e.fillStyle="white",e.beginPath(),e.ellipse(i.x,r+l/2,s/3,10,.2,0,Math.PI*2),e.fill();break;case"HOLE":e.fillStyle="#000",e.beginPath(),e.ellipse(i.x,r+l/2,s/2,l/2,0,0,Math.PI*2),e.fill(),e.strokeStyle="#333",e.lineWidth=2,e.stroke();break;case"CAR":e.fillStyle="#3F51B5",e.fillRect(t,r,s,l),e.fillStyle="#81D4FA",e.fillRect(t+2,r+2,s-4,15),e.fillStyle="red",e.fillRect(t+2,r+l-5,10,5),e.fillRect(t+s-12,r+l-5,10,5),i.warning&&i.y<0&&(e.fillStyle="red",e.font="bold 40px Arial",e.textAlign="center",e.fillText("!",i.x,100),e.strokeStyle="yellow",e.lineWidth=2,e.strokeText("!",i.x,100));break;default:e.fillStyle="#795548",e.fillRect(t,r,s,l),e.strokeStyle="#3E2723",e.lineWidth=3,e.strokeRect(t,r,s,l),e.beginPath(),e.moveTo(t,r),e.lineTo(t+s,r+l),e.moveTo(t+s,r),e.lineTo(t,r+l),e.stroke()}},ie=(e,i)=>{const{x:t,y:r,isSliding:s,isDashing:l,isHit:o,isConfused:c,frame:n}=i,f=h.CANVAS_HEIGHT-h.PLAYER_HEIGHT-30-r,u=h.PLAYER_WIDTH,d=s?h.PLAYER_HEIGHT/2:h.PLAYER_HEIGHT;if(o&&Math.floor(Date.now()/100)%2===0)return;e.save(),e.translate(t,f),c&&e.rotate(Math.sin(n*.2)*.2),e.fillStyle="rgba(0,0,0,0.4)",e.beginPath();const T=r+d+10,R=Math.max(.3,1-r/150);e.ellipse(0,T,u/2*R,6*R,0,0,Math.PI*2),e.fill();const E=l?"#00FFFF":"#0057B8",y="#C0C0C0";if(s)e.fillStyle="rgba(255, 255, 255, 0.2)",e.beginPath(),e.moveTo(-u/2,d),e.lineTo(u/2,d),e.lineTo(0,-20),e.fill(),e.fillStyle=E,e.beginPath(),e.ellipse(0,d/2,u/1.5,d/1.5,0,0,Math.PI*2),e.fill(),e.fillStyle=y,e.beginPath(),e.arc(0,0,14,0,Math.PI*2),e.fill();else{const S=Math.sin(n*.4)*20;e.lineCap="round",e.lineJoin="round",e.lineWidth=12,e.strokeStyle="#003d82",e.beginPath(),e.moveTo(0,d-30),e.lineTo(-S,d),e.stroke(),e.strokeStyle=E,e.beginPath(),e.moveTo(0,d-30),e.lineTo(S,d),e.stroke(),e.fillStyle=E,e.beginPath(),e.moveTo(-18,0),e.lineTo(18,0),e.lineTo(12,d-30),e.lineTo(-12,d-30),e.fill(),e.fillStyle=y,e.beginPath(),e.moveTo(-5,10),e.lineTo(5,10),e.lineTo(2,40),e.lineTo(-2,40),e.fill();const g=Math.sin(n*.4)*20;e.strokeStyle=y,e.lineWidth=10,e.beginPath(),e.moveTo(0,10),e.lineTo(-g*1.5,35),e.stroke(),e.fillStyle=y,e.beginPath(),e.arc(0,-12,14,0,Math.PI*2),e.fill(),e.fillStyle="#111",e.beginPath(),e.ellipse(0,-10,8,3,0,0,Math.PI*2),e.fill()}e.restore()},re=({score:e,highScore:i,lives:t,cans:r,level:s})=>m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"absolute top-4 left-4 text-white font-mono z-20 drop-shadow-md pointer-events-none",children:[m.jsxs("div",{className:"text-3xl font-black italic text-yellow-400 tracking-tighter",style:{textShadow:"2px 2px 0 #004B93"},children:["SCORE: ",e]}),m.jsxs("div",{className:"text-sm text-gray-400 font-bold",children:["HI: ",i]})]}),m.jsxs("div",{className:"absolute top-4 right-4 text-white font-mono z-20 text-right drop-shadow-md pointer-events-none",children:[m.jsx("div",{className:"text-2xl font-bold text-red-500 mb-1",children:"â¤ï¸".repeat(Math.max(0,t))}),m.jsxs("div",{className:"flex items-center justify-end gap-2 text-blue-300 font-bold",children:[m.jsx("span",{children:"CANS:"}),m.jsxs("span",{className:"text-xl text-white",children:[r,"/100"]})]}),m.jsxs("div",{className:"text-xs text-gray-500 font-bold mt-1",children:["SPEED LVL: ",s]})]})]}),le=({actions:e})=>{const i=a.useRef(0),t=a.useRef(0),r=a.useRef(0),s=a.useRef(!1),l=c=>{i.current=c.touches[0].clientX,t.current=c.touches[0].clientY,r.current=Date.now(),s.current=!1,setTimeout(()=>{r.current!==0&&(s.current=!0,e.slide())},250)},o=c=>{c.cancelable&&c.preventDefault();const n=c.changedTouches[0].clientX,f=c.changedTouches[0].clientY;r.current=0;const u=i.current-n,d=t.current-f;if(!s.current)if(Math.abs(u)>30||Math.abs(d)>30)Math.abs(u)>Math.abs(d)?u>0?e.moveLeft():e.moveRight():d>0?e.dash():e.slide();else{const T=window.innerWidth;i.current<T*.3?e.moveLeft():i.current>T*.7?e.moveRight():e.jump()}};return m.jsx("div",{className:"absolute inset-0 z-50 touch-none select-none",onTouchStart:l,onTouchEnd:o})},ae=({score:e,onRestart:i,onExit:t})=>m.jsxs("div",{className:"absolute inset-0 z-30 bg-black/80 backdrop-blur-sm flex flex-col items-center justify-center text-white animate-in zoom-in duration-300",children:[m.jsx("h2",{className:"text-6xl font-black text-red-600 mb-2 italic tracking-tighter transform -rotate-3",style:{textShadow:"4px 4px 0 #000"},children:"CRASHED!"}),m.jsxs("p",{className:"text-2xl mb-8 font-mono text-yellow-400",children:["FINAL SCORE: ",e]}),m.jsxs("div",{className:"flex flex-col gap-4 w-64",children:[m.jsx("button",{onClick:i,className:"px-8 py-4 bg-blue-600 hover:bg-blue-500 text-white font-black rounded-xl shadow-[0_6px_0_rgb(0,40,100)] active:shadow-none active:translate-y-1 transition-all uppercase tracking-widest",children:"TRY AGAIN"}),m.jsx("button",{onClick:t,className:"px-8 py-4 bg-gray-700 hover:bg-gray-600 text-gray-300 font-bold rounded-xl shadow-[0_6px_0_rgb(30,30,30)] active:shadow-none active:translate-y-1 transition-all uppercase tracking-widest",children:"EXIT"})]})]}),oe=({onExit:e})=>{const{status:i,startGame:t,player:r,entitiesRef:s,stats:l,actions:o}=$(),c=a.useRef(null),n=a.useRef(0),f=a.useRef(!1);Q(i,o);const u=a.useCallback(()=>{const d=c.current;if(!d)return;const T=d.getContext("2d");if(!T)return;T.clearRect(0,0,d.width,d.height);const R=h.INITIAL_SPEED+l.level*.5;te(T,d.width,d.height,R),se(T,s.current),ie(T,r),n.current=requestAnimationFrame(u)},[r,s,l.level]);return a.useEffect(()=>(n.current=requestAnimationFrame(u),()=>cancelAnimationFrame(n.current)),[u]),a.useEffect(()=>{if(!f.current){ee();const d=setTimeout(()=>t(),100);return f.current=!0,()=>clearTimeout(d)}},[t]),m.jsxs("div",{className:"fixed inset-0 z-[10000] bg-black flex items-center justify-center overflow-hidden font-sans select-none",children:[m.jsx(re,{score:l.score,highScore:l.highScore,lives:l.lives,cans:l.cans,level:l.level}),i==="PLAYING"&&m.jsx(le,{actions:o}),m.jsx("canvas",{ref:c,width:h.CANVAS_WIDTH,height:h.CANVAS_HEIGHT,className:"bg-[#222] max-h-full max-w-full shadow-2xl border-4 border-blue-900 rounded-lg pointer-events-none",style:{imageRendering:"pixelated"}}),i==="GAME_OVER"&&m.jsx(ae,{score:l.score,onRestart:t,onExit:e})]})},fe=({onExit:e})=>m.jsx(a.Suspense,{fallback:m.jsx("div",{className:"fixed inset-0 z-[10000] bg-black flex items-center justify-center text-blue-500",children:"LOADING ASSETS..."}),children:m.jsx(oe,{onExit:e})});export{fe as GameLauncher};
